{% extends "base.html" %}

{% block title %}{{ config.title }}{% endblock %}

{% block content %}
<!-- Hero Section with Video Background -->
<section class="hero-section">
    {% if frontmatter.videoSrc %}
        {% if frontmatter.videoSrc.endswith('.svg') %}
        <div class="svg-background">
            <div class="svg-container" style="background-image: url('{{ frontmatter.videoSrc }}');"></div>
            <div class="video-overlay"></div>
        </div>
        {% else %}
        <div class="video-background">
            <video autoplay muted loop playsinline class="background-video">
                <source src="{{ frontmatter.videoSrc }}" type="video/mp4">
            </video>
            <div class="video-overlay"></div>
        </div>
        {% endif %}
    {% endif %}
    
    <div class="container hero-content">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                {% if frontmatter.heroImage %}
                    <img src="{{ frontmatter.heroImage }}" alt="{{ frontmatter.heroText or config.title }}" class="mb-4" style="max-height: 120px;">
                {% endif %}
                
                <h1 class="hero-title">{{ frontmatter.heroText or config.title }}</h1>
                
                {% if frontmatter.tagline %}
                    <p class="hero-tagline">{{ frontmatter.tagline }}</p>
                {% endif %}
                
                {% if frontmatter.overview %}
                    <p class="hero-tagline">{{ frontmatter.overview }}</p>
                {% endif %}
                
                {% if frontmatter.actions %}
                    <div class="mt-4 hero-buttons">
                        {% for action in frontmatter.actions %}
                            <a href="{{ action.link }}" class="btn-hero">
                                {{ action.text }}
                            </a>
                        {% endfor %}
                        <a href="http://lcxm.shumengya.top" class="btn-hero" target="_blank">
                            灵创作品集
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
{% if frontmatter.features %}
<section class="features-section">
    <div class="container">
        <div class="row">
            {% for feature in frontmatter.features %}
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="feature-card">
                        <h3 class="feature-title">{{ feature.title }}</h3>
                        <p class="text-muted">{{ feature.details }}</p>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<!-- Slogan Section -->
{% if frontmatter.slogan %}
<section class="py-5 bg-light">
    <div class="container text-center">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                {% if frontmatter.slogan.fisrt %}
                    <h2 class="mb-3">{{ frontmatter.slogan.fisrt }}</h2>
                {% endif %}
                {% if frontmatter.slogan.second %}
                    <h3 class="text-primary">{{ frontmatter.slogan.second }}</h3>
                {% endif %}
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- Additional Content -->
{% if content and content.strip() %}
<section class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="main-content">
                    {{ content | safe }}
                </div>
            </div>
        </div>
    </div>
</section>
{% endif %}
{% endblock %}

{% block extra_scripts %}
<style>
    /* 视频背景样式 */
    .hero-section {
        position: relative;
        overflow: hidden;
        min-height: 100vh;
        display: flex;
        align-items: center;
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    }
    
    .video-background,
    .svg-background {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
    }
    
    .background-video {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
    }
    
    .svg-container {
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
    }
    
    .video-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.4);
        z-index: 2;
    }
    
    .hero-content {
        position: relative;
        z-index: 3;
        width: 100%;
    }
    
    /* 按钮样式 */
    .hero-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        justify-content: center;
        align-items: center;
    }
    
    .btn-hero {
        flex: 1;
        min-width: 150px;
        max-width: 200px;
        text-align: center;
        white-space: nowrap;
        background-color: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border: 2px solid rgba(255, 255, 255, 0.3);
    }
    
    .btn-hero:hover {
        background-color: rgba(255, 255, 255, 1);
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }
    
    /* 首页移动端适配 */
    @media (max-width: 1024px) {
        .hero-section {
            min-height: 80vh;
            padding: 3rem 0;
        }
        
        .features-section {
            padding: 3rem 0;
        }
        
        .feature-card {
            margin-bottom: 1.5rem;
        }
        
        .hero-title {
            font-size: 2.5rem;
        }
        
        .hero-tagline {
            font-size: 1.1rem;
        }
    }
    
    @media (max-width: 768px) {
        .hero-section {
            min-height: 70vh;
            padding: 2rem 0;
        }
        
        .hero-title {
            font-size: 2rem;
            line-height: 1.2;
        }
        
        .hero-tagline {
            font-size: 1rem;
        }
        
        .features-section {
            padding: 2rem 0;
        }
        
        .feature-card {
            margin-bottom: 1rem;
            padding: 1.5rem;
        }
        
        .hero-buttons {
            flex-direction: row;
            gap: 0.5rem;
        }
        
        .btn-hero {
            flex: 1;
            min-width: 120px;
            font-size: 0.9rem;
            padding: 0.6rem 0.8rem;
        }
        
        /* 移动端视频优化 */
        .background-video {
            object-position: center center;
        }
        
        .video-overlay {
            background: rgba(0, 0, 0, 0.5);
        }
    }
    
    @media (max-width: 480px) {
        .hero-section {
            min-height: 60vh;
            padding: 1.5rem 0;
        }
        
        .hero-title {
            font-size: 1.75rem;
        }
        
        .hero-tagline {
            font-size: 0.9rem;
        }
        
        .hero-buttons {
            flex-direction: row;
            gap: 0.3rem;
        }
        
        .btn-hero {
            flex: 1;
            min-width: 100px;
            font-size: 0.8rem;
            padding: 0.5rem 0.5rem;
        }
        
        .feature-card {
            padding: 1rem;
        }
        
        .feature-title {
            font-size: 1.1rem;
        }
        
        /* 小屏幕视频优化 */
        .video-overlay {
            background: rgba(0, 0, 0, 0.6);
        }
    }
</style>

<script>
    // 添加一些交互效果
    document.addEventListener('DOMContentLoaded', function() {
        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        
        // 特性卡片悬停效果（仅在非触摸设备上启用）
        if (!('ontouchstart' in window)) {
            document.querySelectorAll('.feature-card').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.borderColor = 'var(--primary-color)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.borderColor = 'var(--border-color)';
                });
            });
        }
        
        // 视频背景优化
        const backgroundVideo = document.querySelector('.background-video');
        const svgBackground = document.querySelector('.svg-background');
        const heroSection = document.querySelector('.hero-section');
        
        if (backgroundVideo && heroSection) {
            // 视频加载失败时的备用方案
            backgroundVideo.addEventListener('error', function() {
                console.log('视频加载失败，使用备用背景');
                const videoBackground = document.querySelector('.video-background');
                if (videoBackground) {
                    videoBackground.style.display = 'none';
                }
                heroSection.style.background = 'linear-gradient(135deg, var(--primary-color), var(--secondary-color))';
            });
            
            // 视频加载超时处理
            const loadTimeout = setTimeout(function() {
                if (backgroundVideo.readyState === 0) {
                    console.log('视频加载超时，使用备用背景');
                    const videoBackground = document.querySelector('.video-background');
                    if (videoBackground) {
                        videoBackground.style.display = 'none';
                    }
                    heroSection.style.background = 'linear-gradient(135deg, var(--primary-color), var(--secondary-color))';
                }
            }, 5000);
            
            // 视频成功加载时清除超时
            backgroundVideo.addEventListener('loadeddata', function() {
                clearTimeout(loadTimeout);
            });
            
            // 移动端性能优化
            if (window.innerWidth <= 768) {
                backgroundVideo.setAttribute('preload', 'metadata');
                // 移动端可能需要用户交互才能播放，添加备用处理
                backgroundVideo.addEventListener('canplay', function() {
                    this.play().catch(function(error) {
                        console.log('视频自动播放失败，这在移动设备上是正常的');
                    });
                });
            } else {
                backgroundVideo.setAttribute('preload', 'auto');
            }
            
            // 确保视频循环播放
            backgroundVideo.addEventListener('ended', function() {
                this.currentTime = 0;
                this.play();
            });
            
            // 页面可见性变化时的处理
            document.addEventListener('visibilitychange', function() {
                if (document.hidden) {
                    backgroundVideo.pause();
                } else {
                    backgroundVideo.play().catch(function(error) {
                        console.log('视频播放失败');
                    });
                }
            });
            
            // 窗口大小变化时的优化
            window.addEventListener('resize', function() {
                if (window.innerWidth <= 768 && !backgroundVideo.hasAttribute('data-mobile-optimized')) {
                    backgroundVideo.setAttribute('data-mobile-optimized', 'true');
                    backgroundVideo.setAttribute('preload', 'metadata');
                }
            });
        } else if (svgBackground && heroSection) {
            // SVG背景已经通过CSS设置，不需要额外处理
            console.log('使用SVG动画背景');
        } else if (heroSection) {
            // 如果没有视频或SVG，确保使用渐变背景
            heroSection.style.background = 'linear-gradient(135deg, var(--primary-color), var(--secondary-color))';
        }
    });
</script>
{% endblock %}